<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Stream Plus</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="tab-header">
    <button class="tab-button active" data-tab="timerTab">Sleep Timer</button>
    <button class="tab-button" data-tab="rulesTab">Rules &amp; Skip</button>
    <button class="tab-button" data-tab="betaTab" id="betaTabBtn">Beta</button>
  </div>

  <!-- Sleep Timer Tab -->
  <div class="tab-content" id="timerTab" style="display:block;">
    <div class="container">
      <h1>Sleep Timer</h1>

      <div class="presets">
        <button class="preset" data-minutes="15">15m</button>
        <button class="preset" data-minutes="30">30m</button>
        <button class="preset" data-minutes="60">60m</button>
      </div>

      <label for="timerInput">Custom time (minutes)</label>
      <input type="number" id="timerInput" min="1" max="480" value="60" />

      <label><input type="checkbox" id="muteInsteadOfPause" /> Mute instead of pause</label>
      <label><input type="checkbox" id="dimScreen" /> Dim screen when timer ends</label>
      <label><input type="checkbox" id="countdownToggle" /> Show countdown in player</label>
      <label><input type="checkbox" id="lowerVolumeCheckbox" /> Lower volume instead of mute/pause</label>

      <div id="volumeLevelContainer" style="display:none; margin-left:20px;">
        Volume level (%):
        <input type="number" id="volumeLevelInput" min="0" max="100" value="10" style="width:60px;" />
      </div>

      <div class="buttons">
        <button id="startBtn">â±ï¸ Start</button>
        <button id="cancelBtn">âŒ Cancel</button>
      </div>

      <div id="suggestion"></div>
      <div id="logContainer"></div>
      <div id="statusMessage"></div>
    </div>
  </div>

  <!-- Rules & Skip Tab -->
  <div class="tab-content" id="rulesTab" style="display:none;">
    <div class="container">
      <h1>Rules &amp; Skip</h1>

      <label><input type="checkbox" id="enableSkipper" /> Enable auto-skip (intro &amp; credits)</label>
      <label><input type="checkbox" id="enablePlayNext" /> Auto-play next episode</label>

      <div style="margin-top:10px;">
        <label for="skipperDelay">Check interval (ms)</label>
        <input type="number" id="skipperDelay" min="100" step="100" value="600" />
      </div>

      <hr style="border:none;border-top:1px solid #2c2d31;margin:12px 0;" />

      <label><input type="checkbox" id="perShowEn" /> Show per-show â€œRulesâ€ chip in Plex</label>
      <div class="hint">Use the chip on a show page to toggle: <em>Skip intro</em>, <em>Skip credits</em>, and <em>Lower volume</em> for that series.</div>

      <div class="buttons" style="margin-top:12px;">
        <button id="openRulesForThisShow">ğŸ› Open rules for this show</button>
        <button id="saveRulesSettings" style="margin-left:auto;">ğŸ’¾ Save</button>
      </div>

      <div id="rulesStatus" class="hint" style="margin-top:8px;"></div>
    </div>
  </div>

  <!-- Beta Tab -->
  <div class="tab-content" id="betaTab" style="display:none;">
    <div class="container">
      <h1 style="display:flex;align-items:center;gap:8px;">
        Beta
        <label title="Master switch for all beta features" style="margin-left:auto;display:flex;align-items:center;gap:6px;cursor:pointer;font-weight:600;">
          <input type="checkbox" id="betaMaster" />
          Enable Beta
        </label>
      </h1>

      <fieldset style="border:1px solid #333;border-radius:8px;padding:10px;margin:10px 0;">
        <legend>Episode Guard</legend>
        <label><input type="checkbox" id="episodeGuardEn" /> Stop after</label>
        <input id="episodeGuardN" type="number" min="1" value="3" style="width:60px"> episodes
        <div class="hint">Resets if playback is stopped for &gt; 10 minutes.</div>
      </fieldset>

      <fieldset style="border:1px solid #333;border-radius:8px;padding:10px;margin:10px 0;">
        <legend>Fade-to-Sleep</legend>
        <label><input type="checkbox" id="fadeEn" /> Fade volume in last</label>
        <input id="fadeMinutes" type="number" min="1" value="5" style="width:60px"> minutes
        <div class="hint">Reduces ~5% every 30s instead of a hard cut.</div>
      </fieldset>

      <button id="saveBeta" style="margin-top:12px;width:100%;">ğŸ’¾ Save Beta Settings</button>
      <div id="betaStatus" class="hint" style="margin-top:8px;"></div>
    </div>
  </div>

  <!-- Donate -->
  <div style="padding:10px;text-align:center;color:#a1a6b0;">
    <button id="donateBtn" data-url="https://square.link/u/JZUUls2L" style="width:100%;">â˜• Buy me a coffee</button>
  </div>

  <script src="popup.js"></script>
</body>
</html>
